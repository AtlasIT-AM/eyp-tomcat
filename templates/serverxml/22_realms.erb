
<%- if @combinedrealm -%>
      <Realm className="org.apache.catalina.realm.CombinedRealm" >
<%- end -%>
<% if @lockoutrealm -%>
         <!-- Use the LockOutRealm to prevent brute-force attack -->
         <Realm className="org.apache.catalina.realm.LockOutRealm">
<% end -%>
  <%- if @userdatabase -%>
  <%- if @pwdigest == 'plaintext' -%>
          <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
                 resourceName="UserDatabase"/>
  <%- else -%>
          <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
                 resourceName="UserDatabase"
                 digest="sha"/>
  <%- end -%>
  <%- end -%>
<% if @lockoutrealm -%>
        </Realm>
<% end -%>
<%- if @combinedrealm -%>
      </Realm>
<%- end -%>
